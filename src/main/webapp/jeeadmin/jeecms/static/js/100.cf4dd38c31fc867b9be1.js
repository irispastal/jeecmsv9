webpackJsonp([100],{DOs3:function(a,e,t){"use strict";function s(a){t("i4Fn")}Object.defineProperty(e,"__esModule",{value:!0});var l=t("3cXf"),n=t.n(l),i=t("hRKE"),o=t.n(i),r=t("lcoF"),d=t("2sCs"),c=t.n(d),f=t("P9l9"),p=t("x1ym"),m={mixins:[r.a],data:function(){var a=this,e=p.a.required("此项必填"),t=p.a.number("只能输入数字"),s=p.a.email("请输入正确的邮箱地址"),l=p.a.validateName("用户名已存在"),n=p.a.tel("请输入正确的固定电话"),i=p.a.mobile("请输入正确的手机号");return{params:{queryUsername:"",https:""},rules:{username:[e,l],email:[s],password:[function(){return{validator:function(e,t,s){""===t?s():t.length<a.passwordMinLen?s(new Error("密码长度不能小于系统设定值:"+a.passwordMinLen)):(""!==a.dataInfo.confirmPassword&&a.$refs.form.validateField("confirmPassword"),s())},trigger:"blur"}}(),e],confirmPassword:[function(){return{validator:function(e,t,s){""===t?s():t!==a.dataInfo.password?s(new Error("前后密码不一致")):s()},trigger:"blur"}}(),e],groupId:[e,t],grain:[e,t],phone:[n],mobile:[i],rank:[t,function(){return{validator:function(a,e,t){""!=e&&c.a.post(f.a.adminValRank,{id:"",rank:e}).then(function(a){""==e?t():"200"==a.code?a.body.result?t():t(new Error("不能大于自身级别")):t(new Error("服务器响应异常"))})},trigger:"blur"}}()],disabled:[e]},memberGroup:[],passwordMinLen:"",roles:[],dialogDepartments:!1,parents:[],departmentList:[],siteList:[],roleIds:[],siteIds:[],allChannels:[],allControlChannels:[],defaultProps:{label:"name",value:"id",children:"child"},dialogVisible:!1}},methods:{getSiteIds:function(a,e){this.siteIds.indexOf(a)>=0?(this.allChannels[e]=!0,this.allControlChannels[e]=!0):(this.allChannels[e]=!1,this.allControlChannels[e]=!1)},getDataInfo:function(a,e){var t=this,s=this.$api;c.a.all([c.a.post(s.adminGlobleGet,{id:a,https:e}),c.a.post(s.groupList),c.a.post(s.roleList),c.a.post(s.departmentList),c.a.post(s.siteList)]).then(c.a.spread(function(a,e,s,l,n){t.dataInfo=a.body,t.passwordMinLen=t.dataInfo.passwordMinLen,t.dataInfo.groupId=1,t.dataInfo.gender=!0,t.dataInfo.rank=1,t.memberGroup=e.body,t.roles=s.body,t.departmentList=t.departmentList.concat({name:"无",pid:"",id:"",priority:"",weights:""}),t.departmentList=t.departmentList.concat(l.body),t.siteList=n.body;for(var i in t.siteList)t.allChannels[i]=!1,t.allControlChannels[i]=!1;t.$refs.form.resetFields(),t.loading=!1})).catch(function(a){t.loading=!1})},add:function(a){var e={};for(var t in this.dataInfo)e[t]=this.dataInfo[t];e.roleIds=e.roleIds.join(","),e.departmentId=this.parents[this.parents.length-1];var s=[];for(var l in e)"object"==o()(e[l])&&delete e[l];for(var i in this.siteIds)for(var r in this.siteList)if(this.siteList[r].id===this.siteIds[i]){var d={siteIds:this.siteIds[i],steps:this.siteIds[i],allChannels:this.allChannels[r],allControlChannels:this.allControlChannels[r]};s.push(d)}e.source=n()(s),this.saveDataInfo(a,this.$api.adminGlobleSave,e,"list")}},created:function(){this.getDataInfo(this.id)}},u=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t("section",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"loading"}],staticClass:"cms-body"},[t("cms-back"),a._v(" "),t("el-form",{ref:"form",staticClass:"cms-form",attrs:{model:a.dataInfo,rules:a.rules,"label-width":"162px"}},[t("el-form-item",{staticClass:"flex-50",attrs:{label:"用户名",prop:"username"}},[t("el-input",{staticClass:"cms-width",model:{value:a.dataInfo.username,callback:function(e){a.$set(a.dataInfo,"username",e)},expression:"dataInfo.username"}})],1),a._v(" "),t("el-form-item",{staticClass:"flex-50",attrs:{label:"电子邮箱",prop:"email"}},[t("el-input",{staticClass:"cms-width",model:{value:a.dataInfo.email,callback:function(e){a.$set(a.dataInfo,"email",e)},expression:"dataInfo.email"}})],1),a._v(" "),t("el-form-item",{staticClass:"flex-50",attrs:{label:"密码",prop:"password"}},[t("el-input",{staticClass:"cms-width",attrs:{type:"password"},model:{value:a.dataInfo.password,callback:function(e){a.$set(a.dataInfo,"password",e)},expression:"dataInfo.password"}})],1),a._v(" "),t("el-form-item",{staticClass:"flex-50",attrs:{label:"确认密码",prop:"confirmPassword"}},[t("el-input",{staticClass:"cms-width",attrs:{type:"password"},model:{value:a.dataInfo.confirmPassword,callback:function(e){a.$set(a.dataInfo,"confirmPassword",e)},expression:"dataInfo.confirmPassword"}})],1),a._v(" "),t("el-form-item",{staticClass:"flex-50",attrs:{label:"会员组",prop:"groupId"}},[t("el-select",{staticClass:"cms-width",model:{value:a.dataInfo.groupId,callback:function(e){a.$set(a.dataInfo,"groupId",e)},expression:"dataInfo.groupId"}},a._l(a.memberGroup,function(a,e){return t("el-option",{key:e,attrs:{label:a.name,value:a.id}})}))],1),a._v(" "),t("el-form-item",{staticClass:"flex-50",attrs:{label:"等级",prop:"rank"}},[t("el-input",{staticClass:"cms-width",attrs:{type:"number"},model:{value:a.dataInfo.rank,callback:function(e){a.$set(a.dataInfo,"rank",e)},expression:"dataInfo.rank"}}),a._v(" "),t("span",{staticClass:"gray"},[a._v("越大等级越高")])],1),a._v(" "),t("el-form-item",{staticClass:"flex-50",attrs:{label:"真实姓名",prop:"realname"}},[t("el-input",{staticClass:"cms-width",attrs:{type:"username"},model:{value:a.dataInfo.realname,callback:function(e){a.$set(a.dataInfo,"realname",e)},expression:"dataInfo.realname"}})],1),a._v(" "),t("el-form-item",{staticClass:"flex-50",attrs:{label:"性别",prop:"gender"}},[t("el-radio-group",{model:{value:a.dataInfo.gender,callback:function(e){a.$set(a.dataInfo,"gender",e)},expression:"dataInfo.gender"}},[t("el-radio",{attrs:{label:!0}},[a._v("男")]),a._v(" "),t("el-radio",{attrs:{label:!1}},[a._v("女")])],1)],1),a._v(" "),t("el-form-item",{staticClass:"flex-100",attrs:{label:"受限管理员",prop:"selfAdmin"}},[t("el-radio-group",{model:{value:a.dataInfo.selfAdmin,callback:function(e){a.$set(a.dataInfo,"selfAdmin",e)},expression:"dataInfo.selfAdmin"}},[t("el-radio",{attrs:{label:!0}},[a._v("是")]),a._v(" "),t("el-radio",{attrs:{label:!1}},[a._v("否")])],1),a._v(" "),t("span",{staticClass:"gray"},[a._v("只能管理自己的数据")])],1),a._v(" "),t("el-form-item",{staticClass:"flex-100",attrs:{label:"角色",prop:"roleIds"}},[t("el-checkbox-group",{model:{value:a.dataInfo.roleIds,callback:function(e){a.$set(a.dataInfo,"roleIds",e)},expression:"dataInfo.roleIds"}},a._l(a.roles,function(e,s){return t("el-checkbox",{key:s,attrs:{value:e.id,label:e.id}},[a._v(a._s(e.name))])})),a._v(" "),t("span",{staticClass:"gray"},[a._v("功能权限的控制在角色中")])],1),a._v(" "),t("el-form-item",{staticClass:"flex-50",attrs:{label:"部门"}},[t("el-cascader",{staticClass:"cms-width",attrs:{options:a.departmentList,props:a.defaultProps,"change-on-select":!0},model:{value:a.parents,callback:function(e){a.parents=e},expression:"parents"}}),a._v(" "),t("span",{staticClass:"gray"},[a._v("内容管理和栏目管理权限集中控制在部门管理中")])],1),a._v(" "),t("el-form-item",{staticClass:"flex-50"}),a._v(" "),t("el-form-item",{staticClass:"flex-100",attrs:{label:"站群权限"}},[t("el-button",{on:{click:function(e){a.dialogVisible=!0}}},[a._v("站群权限")]),a._v(" "),t("el-dialog",{attrs:{title:"站群权限设置",visible:a.dialogVisible},on:{"update:visible":function(e){a.dialogVisible=e}}},[t("div",{staticClass:"channels-box"},[t("el-checkbox-group",{staticClass:"pull-left check-vertical",model:{value:a.siteIds,callback:function(e){a.siteIds=e},expression:"siteIds"}},a._l(a.siteList,function(e,s){return t("el-checkbox",{key:s,attrs:{label:e.id},on:{change:function(t){a.getSiteIds(e.id,s)}}},[a._v(a._s(e.name))])})),a._v(" "),t("div",{staticClass:"pull-left"},a._l(a.siteList,function(e,s){return t("div",{key:s,staticClass:"cms-channels"},[t("el-checkbox",{attrs:{"false-label":"",disabled:"-1"==a.siteIds.indexOf(e.id)},model:{value:a.allChannels[s],callback:function(e){a.$set(a.allChannels,s,e)},expression:"allChannels[index]"}},[a._v("所有栏目内容权限")]),a._v(" "),t("el-checkbox",{attrs:{"false-label":"",disabled:"-1"==a.siteIds.indexOf(e.id)},model:{value:a.allControlChannels[s],callback:function(e){a.$set(a.allControlChannels,s,e)},expression:"allControlChannels[index]"}},[a._v("所有栏目控制权限")])],1)}))],1),a._v(" "),t("div",{staticClass:"form-footer"},[t("el-button",{on:{click:function(e){a.dialogVisible=!1}}},[a._v("确定")])],1)]),a._v(" "),t("span",{staticClass:"gray"})],1),a._v(" "),t("div",{staticClass:"form-footer"},[t("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/adminGlobal/add",expression:"'/adminGlobal/add'"}],attrs:{type:"warning"},on:{click:function(e){a.add(!0)}}},[a._v("保存并继续添加")]),a._v(" "),t("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/adminGlobal/add",expression:"'/adminGlobal/add'"}],attrs:{type:"primary"},on:{click:function(e){a.add(!1)}}},[a._v("提交")]),a._v(" "),t("el-button",{attrs:{type:"info"},on:{click:a.$reset}},[a._v("重置")])],1)],1)],1)},v=[],b={render:u,staticRenderFns:v},h=b,I=t("Z0/y"),C=s,g=I(m,h,!1,C,"data-v-4ac324be",null);e.default=g.exports},gZcN:function(a,e,t){e=a.exports=t("UTlt")(!1),e.push([a.i,"",""])},i4Fn:function(a,e,t){var s=t("gZcN");"string"==typeof s&&(s=[[a.i,s,""]]),s.locals&&(a.exports=s.locals);t("FIqI")("07344eac",s,!0,{})}});